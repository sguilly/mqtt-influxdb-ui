/**
 * mqtt-influxdb-ui - express middleware - add a mqtt-influxdb-ui route to your web app
 * @authors 
 * @version v0.1.0
 * @link https://github.com/sguilly/mqtt-influxdb-ui
 * @license MIT
 */
!function(){"use strict";angular.module("app",["app.core","app.topics","app.etl","app.approot","app.dashboard"])}(),function(){"use strict";angular.module("app.core",["ngAnimate","ngMaterial","ngSanitize","fw.exception","fw.logger","ui.router","restangular","md.data.table"])}(),function(){"use strict";angular.module("fw.exception",["fw.logger"])}(),function(){"use strict";angular.module("fw.logger",["ngMaterial"])}(),function(){"use strict";angular.module("app.appbar",["app.core"])}(),function(){"use strict";angular.module("app.approot",["app.core"])}(),function(){"use strict";angular.module("app.dashboard",["app.core"])}(),function(){"use strict";angular.module("app.etl",["app.core"])}(),function(){"use strict";angular.module("app.topics",["app.core"])}(),function(){"use strict";function e(e,t,n,l,a,r){r.defaults.useXDomain=!0,e.debugInfoEnabled(!1),t.debugEnabled&&t.debugEnabled(!0),a.configure(o.appErrorPrefix),n.iconSet("content","images/content-icons.svg",24).iconSet("navigation","images/navigation-icons.svg",24).iconSet("refresh","images/ic_refresh_black_24px.svg",24),l.theme("default").primaryPalette("blue-grey")}var t=angular.module("app.core"),o={appErrorPrefix:"[Angular Template Error] ",appTitle:"Angular Template"};t.value("config",o),t.config(e),e.$inject=["$compileProvider","$logProvider","$mdIconProvider","$mdThemingProvider","exceptionHandlerProvider","$httpProvider"]}(),function(){"use strict";angular.module("app.core").constant("_",_).constant("api","http://localhost:7203/api")}(),function(){"use strict";var e=angular.module("app.core");e.factory("MoscaRestangular",["Restangular",function(e){return e.withConfig(function(e){e.setBaseUrl("http://localhost:2003")})}])}(),function(){"use strict";var e=angular.module("app.core");e.filter("stringToDate",function(){return function(e){var t=new Date(Number(e));return new Date(t)}})}(),function(){"use strict";function e(e,t,o){o.otherwise("/"),t.state("dashboard",{url:"/",template:'<tmpl-dashboard class="page"></tmpl-dashboard>'}).state("etl",{url:"/etl",template:'<tmpl-etl class="page"></tmpl-etl>'}).state("etl-model",{url:"/etl-model/:objectId",template:'<tmpl-etl-model class="page"></tmpl-etl-model>'}).state("topics",{url:"/topics",template:'<tmpl-topics class="page"></tmpl-topics>'})}var t=angular.module("app.core");t.config(e),e.$inject=["$locationProvider","$stateProvider","$urlRouterProvider"]}(),function(){"use strict";function e(e){console.log("set Restangular"),e.setBaseUrl("http://localhost:5080/mqtt-influxdb-ui")}var t=angular.module("app.core");t.run(e),e.$inject=["Restangular"]}(),function(){"use strict";function e(){this.config={appErrorPrefix:void 0},this.configure=function(e){this.config.appErrorPrefix=e},this.$get=function(){return{config:this.config}}}function t(e){e.decorator("$exceptionHandler",o)}function o(e,t,o){return function(n,l){var a=o.get("logger"),r=t.config.appErrorPrefix||"",i={exception:n,cause:l};n.message=r+n.message,e(n,l),a.error(n.message,i)}}angular.module("fw.exception").provider("exceptionHandler",e).config(t),t.$inject=["$provide"],o.$inject=["$delegate","exceptionHandler","$injector"]}(),function(){"use strict";function e(e){function t(t){return function(o){e.error(t,o)}}var o={catcher:t};return o}angular.module("fw.exception").factory("exception",e),e.$inject=["logger"]}(),function(){"use strict";function e(e,t){function o(t){e.log("log: "+t)}function n(o){t.showSimple("Info: "+o),e.info("info: "+o)}function l(o){t.showSimple("Success: "+o),e.info("success: "+o)}function a(o){t.showSimple("Warning: "+o),e.warn("warn: "+o)}function r(o){t.showSimple("Error: "+o),e.error("error: "+o)}function i(t){e.debug("debug: "+t)}var s={log:o,info:n,success:l,warn:a,error:r,debug:i};return s}angular.module("fw.logger").factory("logger",e),e.$inject=["$log","$mdToast"]}(),function(){"use strict";function e(){var e={restrict:"E",templateUrl:"components/appbar/appbar.html",scope:{},controller:"AppbarController",controllerAs:"vm"};return e}function t(e,t){function o(){t("left").toggle()}function n(){e.show({templateUrl:"components/login/login-dialog.html",controller:"LoginDialogController",controllerAs:"vm"})}var l=this;l.login=n,l.toggleSidenav=o}angular.module("app.appbar").directive("tmplAppbar",e).controller("AppbarController",t),e.$inject=[],t.$inject=["$mdDialog","$mdSidenav"]}(),function(){"use strict";function e(){var e={restrict:"E",templateUrl:"components/approot/approot.html",scope:{}};return e}angular.module("app.approot").directive("tmplApproot",e)}(),function(){"use strict";function e(e,t){var o=this;o.selected=[],o.searchText="",o.mdOptions=[10,50,100],o.query={order:"values.rss",limit:10,page:1};var n=t.all("data");o.removeAll=function(){n.customDELETE("deleteAll",{}).then(function(){o.loadData()})},o.removeSelected=function(){console.log("Selected=",o.selected);for(var e=[],t=0;t<o.selected.length;t++)e.push(o.selected[t].remove());Promise.all(e).then(function(){o.loadData()})},o.remove=function(e){e.remove()},o.loadData=function(){o.promise=n.getList(),o.promise.then(function(e){o.rawData=e})},o.onPaginate=function(e,t){console.log("Scope Page: "+o.query.page+" Scope Limit: "+o.query.limit),console.log("Page: "+e+" Limit: "+t)},o.loadData()}angular.module("app.dashboard").controller("DashboardController",e),e.$inject=["logger","Restangular"]}(),function(){"use strict";function e(){var e={restrict:"E",templateUrl:"components/dashboard/dashboard.html",scope:{},controller:"DashboardController",controllerAs:"vm"};return e}angular.module("app.dashboard").directive("tmplDashboard",e),e.$inject=[]}(),function(){"use strict";function e(e,t,o){function n(){e.log("Activated Accounts View")}var l=this;n(),l.selected=[],l.searchText="",l.query={order:"values.rss",limit:5,page:1};var a=t.all("etl");l.addDecoder=function(){console.log("add"),o.go("etl-model")},l.update=function(e){console.log("update:",e),e.topic="abc/abc",e.put()},a.getList({query:{toto:"tt"}}).then(function(e){console.log("values=",e.length),console.log(JSON.stringify(e[0],null,3)),l.rawData=e})}angular.module("app.etl").controller("EtlController",e),e.$inject=["logger","Restangular","$state"]}(),function(){"use strict";function e(){var e={restrict:"E",templateUrl:"components/etl/list/etl.html",scope:{},controller:"EtlController",controllerAs:"vm"};return e}angular.module("app.etl").directive("tmplEtl",e),e.$inject=[]}(),function(){"use strict";function e(e,t,o,n){function l(){e.log("Activated Accounts View")}var a=this;o.objectId&&(console.log(o.objectId),t.one("etl",o.objectId).get().then(function(e){console.log(e),a.etl=e,console.log("vm.etl.timeKeys=",typeof a.etl.params.timeKeys)})),a.remove=function(){a.etl.remove().then(function(){n.go("etl")})},a.save=function(){console.log("save"),a.etl._id?("string"==typeof a.etl.params.timeKeys&&(a.etl.params.timeKeys=a.etl.params.timeKeys.split(",")),"string"==typeof a.etl.params.tagKeys&&(a.etl.params.tagKeys=a.etl.params.tagKeys.split(",")),"string"==typeof a.etl.params.denyKeys&&(a.etl.params.tagKeys=a.etl.params.denyKeys.split(",")),a.etl.put()):(console.log("nouveau etl"),t.all("etl").post(a.etl).then(function(e){a.etl=e}))},l()}angular.module("app.etl").controller("EtlModelController",e),e.$inject=["logger","Restangular","$stateParams","$state"]}(),function(){"use strict";function e(){var e={restrict:"E",templateUrl:"components/etl/model/etl-model.html",scope:{},controller:"EtlModelController",controllerAs:"vm"};return e}angular.module("app.etl").directive("tmplEtlModel",e),e.$inject=[]}(),function(){"use strict";function e(e,t){var o=this;o.selected=[],o.searchText="",o.mdOptions=[10,20,50,100],o.query={order:"values.rss",limit:20,page:1},o.refreshTooltip=function(e){t.one("topics",e).get().then(function(e){e[0]&&(o.tooltip=JSON.parse(e[0]).payload)})},o.refresh=function(){o.loadData()},o.removeSelected=function(){console.log("Selected=",o.selected);for(var e=[],t=0;t<o.selected.length;t++)e.push(o.selected[t].remove());Promise.all(e).then(function(){o.selected=[],o.loadData()})},o.loadData=function(){t.all("topics").getList().then(function(e){console.log("mqtt list",e),o.rawData=e})},o.loadData()}angular.module("app.topics").controller("TopicsController",e),e.$inject=["logger","Restangular"]}(),function(){"use strict";function e(){var e={restrict:"E",templateUrl:"components/topics/list/topics.html",scope:{},controller:"TopicsController",controllerAs:"vm"};return e}angular.module("app.topics").directive("tmplTopics",e),e.$inject=[]}(),angular.module("app.core").run(["$templateCache",function(e){e.put("components/appbar/appbar.html",'<md-toolbar layout=row><md-button class=md-icon-button hide-gt-sm ng-click=vm.toggleSidenav() aria-label="Show Navbar"><md-icon md-svg-icon=navigation:menu></md-icon></md-button><div class=md-toolbar-tools><span>Mqtt To Influxdb (ETL)</span> <span flex></span></div></md-toolbar>'),e.put("components/approot/approot.html",'<section layout=row layout-sm=column layout-align="start center"><md-button class="groupX left" ui-sref=etl>ETL Conf</md-button><md-button class="groupX middle" ui-sref=dashboard>Messages</md-button><md-button class="groupX right" ui-sref=topics>Last Topics info</md-button></section><div flex layout=row><md-content flex layout-padding id=content><div ui-view></div></md-content></div>'),e.put("components/dashboard/dashboard.html","<div layout=row><h1>Messages in the queue</h1><md-button class=md-raised ng-click=vm.removeAll()>Delete All</md-button></div><div class=md-toolbar-tools ng-show=vm.selected.length><span>{{vm.selected.length}} {{vm.selected.length > 1 ? 'items' : 'item'}} selected</span><md-button class=md-raised ng-click=vm.removeSelected()>Delete Selection</md-button></div><label>Search: <input ng-model=vm.searchText></label><md-table-container><table md-table md-progress=vm.promise md-row-select=true ng-model=vm.selected><thead md-head md-order=vm.query.order><tr md-row><th md-column md-order-by=seriesName><span>seriesName</span></th><th md-column md-order-by=values><span>values</span></th><th md-column md-order-by=tags><span>tags</span></th></tr></thead><tbody md-body><tr md-row md-select=line md-select-id={{line._id}} md-auto-select ng-repeat=\"line in vm.rawData | orderBy: vm.query.order | filter:vm.searchText | limitTo: vm.query.limit: (vm.query.page - 1) * vm.query.limit\"><td md-cell>{{line.seriesName}}</td><td md-cell>{{line.values}}</td><td md-cell>{{line.tags}}</td></tr></tbody></table></md-table-container><md-table-pagination mdboundarylinks md-limit=vm.query.limit md-options=vm.mdOptions md-page=vm.query.page md-total={{vm.rawData.length}} md-on-paginate=vm.onPaginate md-page-select></md-table-pagination>"),e.put("components/etl/model/etl-model.html","<h1>{{vm.etl._id}}</h1><md-button class=md-raised ng-click=vm.save()>Sauvegarder</md-button><md-button class=md-raised ng-click=vm.remove()>Effacer</md-button><md-content layout-padding><div><form name=userForm><div layout=row><md-input-container class=md-block flex-sm=30 flex=20><md-select ng-model=vm.etl.params.qos><md-option value=0>0</md-option><md-option value=1>1</md-option></md-select><label>QOS</label></md-input-container><md-input-container class=md-block flex=80><label>mqtt topic name</label> <input ng-model=vm.etl.topic></md-input-container></div><div layout=row><md-input-container class=md-block flex><label>seriesName in influxdb</label> <input ng-model=vm.etl.params.seriesName></md-input-container></div><div layout=row><md-input-container class=md-block flex><label>timeKeys (ex: time,date)</label> <input ng-model=vm.etl.params.timeKeys></md-input-container></div><div layout=row><md-input-container class=md-block flex><label>denyKeys (ex: val45,val52,val63)</label> <input ng-model=vm.etl.params.denyKeys></md-input-container></div><div layout=row><md-input-container class=md-block flex><label>tagKeys (ex: tag4,tag12,tag6)</label> <input ng-model=vm.etl.params.tagKeys></md-input-container></div><div layout=row><md-checkbox ng-model=vm.etl.params.allowString>Insert string key as a value</md-checkbox></div></form></div></md-content>"),e.put("components/topics/list/topics.html",'<div layout-align="start center" layout=row><h1>Topics</h1><md-button class=md-icon-button ng-click=vm.refresh()><md-icon md-svg-icon=navigation:refresh></md-icon></md-button><span flex=5></span><md-input-container class=md-block flex><label>url mosca api</label> <input ng-model=vm.moscaApiUrl></md-input-container><span flex=5></span> <label>Search: <input ng-model=vm.searchText></label></div><div class=md-toolbar-tools ng-show=vm.selected.length><span>{{vm.selected.length}} {{vm.selected.length > 1 ? \'items\' : \'item\'}} selected</span><md-button class=md-raised ng-click=vm.removeSelected()>Delete Selection</md-button></div><md-table-pagination mdboundarylinks md-limit=vm.query.limit md-options=vm.mdOptions md-page=vm.query.page md-total={{vm.rawData.length}} md-on-paginate=vm.onPaginate md-page-select></md-table-pagination><md-table-container><table md-table md-progress=vm.promise md-row-select=true ng-model=vm.selected><thead md-head md-order=vm.query.order><tr md-row><th md-column md-order-by=id><span>Topic</span></th><th md-column md-order-by=date><span>Last Date</span></th></tr></thead><tbody md-body><tr md-row md-select=line md-select-id={{line._id}} ng-repeat="line in vm.rawData | orderBy: vm.query.order | filter:vm.searchText | limitTo: vm.query.limit: (vm.query.page - 1) * vm.query.limit"><td md-cell ng-mouseover=vm.refreshTooltip(line.id)>{{line.id}}<md-tooltip md-direction=top style="font-size: 20px">{{vm.tooltip}}</md-tooltip></td><td md-cell>{{line.date | stringToDate}}</td></tr></tbody></table></md-table-container><md-table-pagination mdboundarylinks md-limit=vm.query.limit md-options=vm.mdOptions md-page=vm.query.page md-total={{vm.rawData.length}} md-on-paginate=vm.onPaginate md-page-select></md-table-pagination>'),e.put("components/etl/list/etl.html","<h1>ETL</h1><md-button ng-click=vm.addDecoder()>ADD A NEW ONE</md-button><div class=md-toolbar-tools ng-show=vm.selected.length><span>{{vm.selected.length}} {{vm.selected.length > 1 ? 'items' : 'item'}} selected</span></div><label>Search: <input ng-model=vm.searchText></label><md-table-container><table md-table md-progress=vm.promise md-row-select=true ng-model=vm.selected><thead md-head md-order=vm.query.order><tr md-row><th md-column md-order-by=topic><span>Topic</span></th><th md-column md-order-by=params><span>Params</span></th></tr></thead><tbody md-body><tr md-row md-select=line md-select-id={{line._id}} ui-sref=\"etl-model({objectId: line._id})\" ng-repeat=\"line in vm.rawData | orderBy: vm.query.order | filter:vm.searchText | limitTo: vm.query.limit: (vm.query.page - 1) * vm.query.limit\"><td md-cell>{{line.topic}}</td><td md-cell>{{line.params}}</td></tr></tbody></table></md-table-container><md-table-pagination mdboundarylinks md-limit=vm.query.limit md-page=vm.query.page md-total={{vm.rawData.length}} md-on-paginate=vm.onPaginate md-page-select></md-table-pagination>")}]);